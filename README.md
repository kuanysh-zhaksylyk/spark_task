# spark_task

## Spark cluster was deployed in local Kubernetes cluster

## From the PostgreSQL database demo, upload the tables to Payspark Data Frames.

## Using this data (without SQL), write the Payspark code in order to:

1. Print the number of movies in each category, sort in descending order.

2. Output 10 actors whose films were rented the most, sort in descending order.

3. Display the category of films that you spent the most money on.

4. Print the names of films that are not in inventory.

5. Bring out the top 3 actors who appeared most in films in the “Children" category. If several actors have the same number of films, output all of them..

6. Output cities with the number of active and inactive customers (active — customer.active = 1). Sort by the number of inactive clients in descending order.

7. Output the category of films that has the largest number of total rental hours in cities (customer.address_id in this city), and which begin with the letter “a". Do the same for cities that have a “-” symbol.